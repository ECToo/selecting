(function(t,e){"use strict";var n=e.selection;var r=e.getSelection;var o=r||n;var a=function(t){var e=Object.prototype.toString.call(t);return typeof t==="object"&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e)&&t.hasOwnProperty("length")&&(t.length===0||typeof t[0]==="object"&&t[0].nodeType>0)};var i=function(t,e){var n;return function(){var r=this,o=arguments;var a=function(){n=null;t.apply(r,o)};clearTimeout(n);n=setTimeout(a,e)}};var c=function(e,n,r){if(r){if("ontouchstart"in t){e.each(function(){v(this,n)});return}e.on("mouseup",i(n,150));return}var o=function(e){if("ontouchstart"in t){v(e,n);return}e.addEventListener("mouseup",i(n,150),false)};if(!a(e)){o(e);return}[].forEach.call(e,function(t){o(t)})};var u=function(t,e,n){var r=function(){var t=f();e(t)};c(t,r,n)};var f=function(){var n="";if(r){n=t.getSelection().toString()}else if(e.selection&&e.selection.type!=="Control"){n=e.selection.createRange().text}return n};var v=function(t,e){var n;var r=function(){t.removeEventListener("touchend",o,false);t.addEventListener("touchend",o,false);if(n){clearInterval(n)}n=setInterval(function(){var t=f();if(t!==""){e(t);o();l(e)}},100)};var o=function(){clearInterval(n);t.removeEventListener("touchend",o,false)};t.addEventListener("touchstart",r,false)};var l=function(t){var e=f();var n=setInterval(function(){if(f()!==e){t(f());e=f()}else if(f()===""){clearInterval(n)}},100)};t.selecting=function(e,n){if(!o){return}var r=t.jQuery&&e instanceof t.jQuery||t.Zepto&&e instanceof t.Zepto;u(e,n,r)}})(window,document);